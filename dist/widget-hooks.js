define(["jquery"],function(a){return{widgetClass:"widget",scriptClass:"dyn-script",vars:{},registered:{},registeredFinalls:{},register:function(a,b,c,d){var e=void 0===c?!1:c;this.registered[a]&&debug("[WARNING] Widget "+a+" was already registered: Override."),this.registered[a]=[e,b,d]},init:function(b){var c,d,e,f,g=[],h={},i=[];for(c in this.registered)g[g.length]=[c,this.registered[c][2]],h[c]=[];for(g.sort(function(a,b){return void 0!==a[1]&&void 0==b[1]?-1:void 0==a[1]&&void 0!==b[1]?1:a[1]<b[1]?1:a[1]>b[1]?-1:0}),b||(b=a("body")),b.find("."+this.widgetClass).each(function(){var b,c,d=a(this),e=d.data("widgetname").split(" ");for(c in e)b=e[c],void 0!==h[b]?h[b].push(d):debug("No method for widget "+b+" provided")}),d=0;d<g.length;d++){if(c=g[d][0],f=h[c],f.length){for(e=0;e<f.length;e++)i[i.length]=f[e],this.initSpecific(f[e],c);this.registeredFinalls[c]&&this.registeredFinalls[c]()}delete h[c]}for(e in i)i[e].removeClass(this.widgetClass)},initSpecific:function(a,b,c){var d=this;try{(a.hasClass(this.widgetClass)||c)&&(this.registered[b][0]?require(this.registered[b][0],function(){d.registered[b][1](a),a.addClass(this.widgetClass+"-initialized")}):(this.registered[b][1](a),a.addClass(this.widgetClass+"-initialized")))}catch(e){return debug("Error during execution of widget "+b+": "+e.message),a.addClass(this.widgetClass+"-error"),!1}return!0}}});